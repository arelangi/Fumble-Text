<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<style>
		input{
			margin-top: 1%;
			margin-left: 5%;
			margin-bottom: 3%;
		}

		label{
			margin-top: 1%;
			margin-left: 5%;
			margin-bottom: 3%;
		}

		#strength{
			margin-left: 0%;
		}

		input.rounded {
			border: 1px solid #ccc;
			width:38%;
			-moz-border-radius: 10px;
			-webkit-border-radius: 10px;
			border-radius: 10px;
			-moz-box-shadow: 2px 2px 3px #666;
			-webkit-box-shadow: 2px 2px 3px #666;
			box-shadow: 1px 1px 1px #666;
			font: normal 13px/100% Verdana, Tahoma, sans-serif; 
			padding: 4px 7px;
			outline: 0;
			-webkit-appearance: none;
		}

		input.rounded:focus {
			border-color: #339933;
		}

		 #explainer{
		 	width:35%;
		 	float: left;
		 	margin-left: 3%;
		 }

		 #app{
		 	width:62%;
		 	margin-left: 38%;
		 	font: normal 13px/100% Verdana, Tahoma, sans-serif; 
		 }

		 div{
		 	margin-top: 2%;
		 }

		 body{
		 	width:100%;
		 	font-family: 'Helvetica Neue', sans-serif;
		 	font-size: 16px;
		 	line-height: 30px;
		 	background-color: #fff;
		 	color: #000;
		 }

		 .styled-button-5 {
			background-color:#CCCCCC;
			color:#fff;
			font: normal 13px/100% Verdana, Tahoma, sans-serif;
			line-height:30px;
			border-radius:20px;
			-webkit-border-radius:20px;
			-moz-border-radius:20px;
			border:0;
			text-shadow:#C17C3A 0 -1px 0;
			width:25%;
			height:10%;
		}  

		 textarea { 
		    padding: 9px; 
		    border: solid 1px #E5E5E5; 
		    outline: 0; 
		    font: normal 16px/100% Verdana, Tahoma, sans-serif; 
		    width: 200px; 
		    
		    box-shadow: rgba(0,0,0, 0.1) 0px 0px 8px;
		    -moz-box-shadow: 2px 2px 3px #666;
			-webkit-box-shadow: 2px 2px 3px #666;
			box-shadow: 1px 1px 1px #666;
		    -moz-border-radius: 10px;
			-webkit-border-radius: 10px;
			border-radius: 10px;
		    } 
		  
		textarea{
		 	width: 85%;
		 	height: 60%;
		 	margin-left: 5%;
		 	margin-top:2%;
		 	margin-bottom: 3%;
		 }
		   
		textarea:hover, 
		textarea:focus { 
		    border-color: #C9C9C9; 
		    -webkit-box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 8px; 
		}         
	</style>
</head>
<body>

	<div id="explainer">
		Hello,<br/> This is a small javascript application that encrypts/decrypts your text given a secret password.
		<br/>
		The application uses the Advanced Encryption Standard (AES) on the client side. Everything happens on the browser, so your data is completely secure.<br/>

		<h4>Encrypt</h4>
		Paste the unencrypted text in the text box and enter a secret password that is at least 8 characters. In order to generate a strong password, you can use the <a href="https://arelangi.github.io/Jumble-Pass/">Jumble-Pass</a>. Click the button to generate encrypted content.

		<h4>Decrypt</h4>
		Paste the encrypted text in the text box and enter the secret password. Select "Decrypt" and click on the button to view the unencrypted text.

	</div>

	<div id="app">
		<textarea id="msg" placeholder="This is where your message goes" required></textarea>
		<br/>
		<label id="txtalert"></label>
		<br/>
		<input id="pw_phrase" class="rounded" placeholder="This is for the strong password" type="password" onkeyup="pw_strength();" required/>
		<input type="radio" name="op" id="enc" value="e" checked = "checked" onclick="radioSelect();" />Encrypt
		<input type="radio" name="op" id="dec" value="d" onclick="radioSelect();" />Decrypt
		<br/>
		<label>Password strength: </label><label id="strength"></label>
		<br/>
		<input id="btn" class="styled-button-5" type="button" value="Encrypt" onclick="submitted();" disabled="true"/>
	</div>

</body>
<script src="cryptojs/rollups/aes.js"></script>
<script src="zxcvbn/zxcvbn.js"></script>
<script>
	function radioSelect(){
		if(document.querySelector('input[name="op"]:checked').value=='e'){
			document.getElementById("btn").value="Encrypt";
		}else{
			document.getElementById("btn").value="Decrypt";
		}
	}

	function submitted(){
		if(document.querySelector('input[name="op"]:checked').value=='e'){
			encrypt();
		}else{
			decrypt();
		}
	}

	function encrypt(){
		if(document.getElementById("msg").value.length>0){
			var encrypted = CryptoJS.AES.encrypt(document.getElementById("msg").value, document.getElementById("pw_phrase").value);
			document.getElementById("msg").value = encrypted.toString();
		}else{
			document.getElementById("txtalert").innerHTML='The message cannot be empty';
			document.getElementById("txtalert").style.color='red';
			//swal("Error", "Message field cannot be empty", "error");
		}
	}

	function decrypt(){
		if(document.getElementById("msg").value.length>0){
			var decrypted = CryptoJS.AES.decrypt(document.getElementById("msg").value, document.getElementById("pw_phrase").value);
			if(decrypted.toString(CryptoJS.enc.Utf8).length>0){
				document.getElementById("msg").value = decrypted.toString(CryptoJS.enc.Utf8);
				document.getElementById("txtalert").innerHTML='';
			}else{
				document.getElementById("txtalert").innerHTML='Wrong password';
				document.getElementById("txtalert").style.color='red';
			}			
		}else{
			document.getElementById("txtalert").innerHTML='The message cannot be empty';
			document.getElementById("txtalert").style.color='red';
			//swal("Cancelled", "Your imaginary file is safe :)", "error");
		}
	}

	function pw_strength() {
	    var pw_phrase = document.getElementById("pw_phrase");
	    var strength = document.getElementById("strength");
	    var score = zxcvbn(pw_phrase.value).score;
	    if(pw_phrase.value.length == 0){
	    	strength.innerHTML = '';
			document.getElementById("btn").disabled = true;
	    	document.getElementById("btn").style.background='#CCCCCC';
	    }
	    else if(pw_phrase.value.length < 8){
	    	strength.innerHTML = 'Too short. Must be greater than 7 characters.';
	    	strength.style.color = 'black';
			document.getElementById("btn").disabled = true;
	    	document.getElementById("btn").style.background='#CCCCCC';
	    }else{
	    	document.getElementById("btn").disabled = false;
	    	document.getElementById("btn").style.background='#49E850';
	    	if (score == '0') {strength.innerHTML = 'Very Weak'; strength.style.color = 'red'; }
		    else if (score == '1') {strength.innerHTML = 'Weak'; strength.style.color = 'red'; }
		    else if (score == '2') {strength.innerHTML = 'So so'; strength.style.color = 'orange'; }
		    else if (score == '3') {strength.innerHTML = 'Okay'; strength.style.color = 'blue'; }
		    else if (score == '4') {strength.innerHTML = 'Strong'; strength.style.color = 'green'; }
		    else strength.innerHTML = '';	
	    }	    
	}
</script>
</html>